let pokemonRepository=function(){let e=[],t=["normal","fighting","flying","poison","ground","rock","bug","ghost","steel","fire","water","grass","electric","psychic","ice","dragon","dark","fairy"],n="https://pokeapi.co/api/v2/pokemon/?limit=150",o=null;function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(){let e=$(".pokedex-box"),l=$("#search-button");l.get(0)||((l=$("<button>")).attr("id","search-button"),l.addClass("btn"),l.text("Search"),l.on("click",()=>{r()}),e.append(l)),function e(){let l=$(".pokedex-box");c(n).then(function(i){i.forEach(e=>{d(e)}),function(){let e=$(".pokedex-list");if(!e)return void console.error("Couldn't find the pokedex list.");let n=$(".menubox");if(n.get(0)){n.removeClass("menubox__visible");let t=$("#search-button");return void(t.get(0)||((t=$("<button>")).attr("id","search-button"),t.addClass("btn"),t.text("Search"),t.on("click",()=>{r()}),t.insertBefore(e)))}(n=$("<div>")).addClass("menubox");let o=$("<h3>");o.css("display","inline"),o.text("Type ");let l=$("<ul>");l.addClass("menu__list container");let i=$("<div>");i.addClass("row"),l.append(i);let p=[];for(let e=0;e<t.length;e++){let n=$("<input>");n.prop({type:"radio",id:"pokeType",name:"type",value:t[e]}),n.on("change",()=>{s(n)});let o=$("<label>");o.prop({for:"menu-item"}),o.text(""+a(t[e])),o.on("click",()=>{n.prop("checked",!0),s(n)});let l=$("<li>");l.addClass("col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"),l.append(n),l.append(o),p.push(l)}p.forEach(e=>{i.append(e)}),n.append(o),n.append(l),n.insertBefore(e)}();let p=$(".formatted");if(p.get(0)&&p.remove(),null!==o){let t=$("<button>");t.addClass("formatted formatted__secondary btn"),t.text("Next"),t.on("click",()=>{n=o,e()}),l.append(t)}})}()}function i(t){return"object"!=typeof t?(console.warn("You can only add objects to the respository."),!1):(e.push(t),!0)}function p(e){u(e).then(function(){(function(e){f(e);let t=e.speciesUrl;return $.ajax(t,{dataType:"json"}).then(function(t){m();for(let n=0;n<t.flavor_text_entries.length;n++){let o=t.flavor_text_entries[n];if("en"===o.language.name){e.description=o.flavor_text;break}}}).catch(function(e){m(),console.log(e)})})(e).then(function(){!function(e){let t=$(".modal-title"),n=$(".modal-body");t.empty(),n.empty();let o=$("<div>");o.addClass("pokebox pokebox__left");let l=$("<h1>");l.text(a(e.name));let i=[];e.types.forEach(e=>{let t=$("<span>");t.addClass("type-style"),t.addClass("type-style__"+e.type.name),t.text(a(e.type.name)),i.push(t)});let p=$("<img>").prop({src:e.imageUrl});p.addClass("pokeimg modal-img"),p.on("dblclick",()=>{p.css("animation-name","rotate3D"),p.css("animation-duration","1s"),p.css("animation-iteration-count","1")});let s=$("<div>");s.addClass("pokebox pokebox__right");let r=$("<h1>");r.text("Info");let d=$("<p>");d.html("Height: "+(e.height/10).toFixed(1)+"m<br>Weight: "+(e.weight/10).toFixed(1)+"kg<br>BMI: "+function(e){let t=10*e.height;return(e.weight/10/t/t*1e4).toFixed(1)}(e)+"<br><br>Description: "+e.description),o.append(l),o.append(p),o.append("<br>"),i.forEach(e=>{o.append(e)}),s.append(r),s.append(d),n.append(o),n.append(s),$("#pokemon-container").modal()}(e)})})}function s(t){!function t(){let a=$(".pokedex-box");let i=$(".pokedex-list");i.get(0)&&i.remove();let p=$(".formatted");p.get(0)&&p.remove();let s=$("<button>");s.addClass("formatted btn");s.text("Reset");s.on("click",()=>{e=[],n="https://pokeapi.co/api/v2/pokemon/?limit=150",o=null,t(),l()});a.append(s)}(),function(t){let n=[];e.forEach(e=>{let t=new Promise(function(t){u(e).then(function(){f(e,"Indexing"),t(e)})});n.push(t)}),Promise.all(n).then(function(n){e=[],n.forEach(e=>{e.types.forEach(n=>{n.type.name==t.prop("value")&&d(e)})}),m()})}(t)}function r(){let e=$(".menubox");if(e.get(0)){e.addClass("menubox__visible"),$("#search-button").remove()}}function d(e){if(!i(e))return;let t,n=$(".pokedex-box"),o=$(".pokedex-list");o.get(0)||((o=$("<ul>")).addClass("pokedex-list container"),(t=$("<div>")).addClass("row"),o.append(t),n.append(o)),t=$(".row").last();let l=$("<li>");l.addClass("col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2");let s=$("<button>");s.addClass("list-btn btn"),s.text(a(e.name)),s.on("click",()=>{p(e)}),l.append(s),t.append(l)}function c(e){return f(null),$.ajax(e,{dataType:"json"}).then(function(e){m(),o=e.next;let t=[];return e.results.forEach(function(e){let n={name:e.name,detailsUrl:e.url};t.push(n)}),t}).catch(function(e){m(),console.error(e)})}function u(e){f(e);let t=e.detailsUrl;return $.ajax(t,{dataType:"json"}).then(function(t){m(),e.id=t.id,e.id>898&&(e.id-=9102),e.imageUrl=t.sprites.front_default,e.speciesUrl=t.species.url,e.height=t.height,e.weight=t.weight,e.types=t.types}).catch(function(e){m(),console.log(e)})}function f(e,t){let n=$(".pokedex-text"),o=$("<h2>");t&&null!==t?o.text(t+" "+e.name+"..."):null===e?o.text("Loading pokemon api..."):o.text("Loading "+e.name+"...");let a=$('<div class="spinner-border text-yellow" role="status"><span class="sr-only">Loading...</span>');n.empty(),n.append(o),n.append(a)}function m(){let e=$(".pokedex-text"),t=$("<h2>");t.text("Pokedex"),e.empty(),e.append(t)}return{add:i,addListItem:d,getAll:function(){return e},loadList:c,loadDetails:u,targetUrl:n,createDocument:l}}();pokemonRepository.createDocument();
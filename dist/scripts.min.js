let pokemonRepository=function(){let e=[],t=["normal","fighting","flying","poison","ground","rock","bug","ghost","steel","fire","water","grass","electric","psychic","ice","dragon","dark","fairy"];function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function o(){let t=$(".pokedex-box"),n=[];if(e.length+150<=899)for(let t=1;t<151;t++){let o=new Promise(function(n){r("https://pokeapi.co/api/v2/pokemon/"+(e.length+t)+"/").then(e=>(a(e),e)).then(e=>{d(e),n(e)})});n.push(o)}else{let t=899-e.length;for(let o=0;o<t;o++){let t=new Promise(function(t){r("https://pokeapi.co/api/v2/pokemon/"+(e.length+o)+"/").then(e=>(a(e),t(e),e)).then(e=>{d(e)})});n.push(t)}}Promise.all(n).then(function(e){e.forEach(e=>{s(e)})}).then(()=>{if(l(),e.length<899){let e=$("<button>");e.addClass("formatted formatted__secondary btn"),e.text("Next"),e.on("click",()=>{o()}),t.append(e)}});let i=$(".formatted");i.get(0)&&i.get(0).remove()}function a(t){return"object"!=typeof t?(console.warn("You can only add objects to the respository."),!1):(e.push(t),!0)}function l(){let e=$(".pokedex-list");if(!e)return void console.error("Couldn't find the pokedex list.");let o=$(".menubox");if(o.get(0)){o.removeClass("menubox__visible");let t=$("#search-button");return void(t.get(0)||((t=$("<button>")).attr("id","search-button"),t.addClass("btn"),t.text("Search"),t.on("click",()=>{p()}),t.insertBefore(e)))}(o=$("<div>")).addClass("menubox");let a=$("<h3>");a.css("display","inline"),a.text("Type ");let l=$("<ul>");l.addClass("menu__list container");let s=$("<div>");s.addClass("row"),l.append(s);let r=[];for(let e=0;e<t.length;e++){let o=$("<input>");o.prop({type:"radio",id:"pokeType",name:"type",value:t[e]}),o.on("change",()=>{i(o)});let a=$("<label>");a.prop({for:"menu-item"}),a.text(""+n(t[e])),a.on("click",()=>{o.prop("checked",!0),i(o)});let l=$("<li>");l.addClass("col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"),l.append(o),l.append(a),r.push(l)}r.forEach(e=>{s.append(e)}),o.append(a),o.append(l),o.insertBefore(e)}function i(t){!function t(){let n=$(".pokedex-box");let a=$(".pokedex-list");a.get(0)&&a.remove();let i=$(".formatted");i.get(0)&&i.remove();let r=$("<button>");r.addClass("formatted btn");r.text("Reset");r.on("click",()=>{t(),function(){let t=$(".pokedex-box"),n=$("#search-button");if(n.get(0)||((n=$("<button>")).attr("id","search-button"),n.addClass("btn"),n.text("Search"),n.on("click",()=>{p()}),t.append(n)),e.forEach(e=>{s(e)}),l(),e.length<899){let e=$("<button>");e.addClass("formatted formatted__secondary btn"),e.text("Next"),e.on("click",()=>{o()}),t.append(e)}let a=$(".formatted");a.get(0)&&a.get(0).remove()}()});n.append("<br>");n.append(r)}(),function(t){e.forEach(e=>{e.types.forEach(n=>{n.type.name===t.prop("value")&&s(e)})})}(t)}function p(){let e=$(".menubox");if(e.get(0)){e.addClass("menubox__visible"),$("#search-button").remove()}}function s(e){let t,o=$(".pokedex-box"),a=$(".pokedex-list");a.get(0)||((a=$("<ul>")).addClass("pokedex-list container"),(t=$("<div>")).addClass("row"),a.append(t),o.append(a)),t=$(".row").last();let l=$("<li>");l.addClass("col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2");let i=$("<button>");i.addClass("list-btn btn"),i.text(n(e.name)),i.on("click",()=>{!function(e){let t=$(".modal-title"),o=$(".modal-body");t.empty(),o.empty();let a=$("<div>");a.addClass("pokebox pokebox__left");let l=$("<h1>");l.text(n(e.name));let i=[];e.types.forEach(e=>{let t=$("<span>");t.addClass("type-style"),t.addClass("type-style__"+e.type.name),t.text(n(e.type.name)),i.push(t)});let p=$("<img>").prop({src:e.imageUrl});p.addClass("pokeimg modal-img"),p.on("dblclick",()=>{p.css("animation-name","rotate3D"),p.css("animation-duration","1s"),p.css("animation-iteration-count","1")});let s=$("<div>");s.addClass("pokebox pokebox__right");let r=$("<h1>");r.text("Info");let d=$("<p>");d.html("Height: "+(e.height/10).toFixed(1)+"m<br>Weight: "+(e.weight/10).toFixed(1)+"kg<br>BMI: "+function(e){let t=10*e.height;return(e.weight/10/t/t*1e4).toFixed(1)}(e)+"<br><br>Description: "+e.description),a.append(l),a.append(p),a.append("<br>"),i.forEach(e=>{a.append(e)}),s.append(r),s.append(d),o.append(a),o.append(s),$("#pokemon-container").modal()}(e)}),l.append(i),t.append(l)}function r(e){return c(null),$.ajax(e,{dataType:"json"}).then(function(e){return u(),{name:e.name,imageUrl:e.sprites.front_default,speciesUrl:e.species.url,height:e.height,weight:e.weight,types:e.types}}).catch(function(e){u(),console.error(e)})}function d(e){c(e);let t=e.speciesUrl;return $.ajax(t,{dataType:"json"}).then(function(t){u();for(let n=0;n<t.flavor_text_entries.length;n++){let o=t.flavor_text_entries[n];if("en"===o.language.name){e.description=o.flavor_text;break}}}).catch(function(e){u(),console.log(e)})}function c(e,t){let n=$(".pokedex-text"),o=$("<h2>");t&&null!==t?o.text(t+" "+e.name+"..."):null===e?o.text("Loading pokemon api..."):o.text("Loading "+e.name+"...");let a=$('<div class="spinner-border text-yellow" role="status"><span class="sr-only">Loading...</span>');n.empty(),n.append(o),n.append(a)}function u(){let e=$(".pokedex-text"),t=$("<h2>");t.text("Pokedex"),e.empty(),e.append(t)}return{add:a,addListItem:s,getAll:function(){return e},loadList:r,targetUrl:"https://pokeapi.co/api/v2/pokemon/?limit=150",createDocument:function(){let e=$(".pokedex-box"),t=$("#search-button");t.get(0)||((t=$("<button>")).attr("id","search-button"),t.addClass("btn"),t.text("Search"),t.on("click",()=>{p()}),e.append(t)),o()}}}();pokemonRepository.createDocument();
